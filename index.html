<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Moonz Lua Obfuscator</title>

<style>
:root{
    --bg:#0b0f1a;--card:rgba(255,255,255,.06);--border:rgba(255,255,255,.12);
    --primary:#6a11cb;--secondary:#2575fc;--text:#eaeaea;--muted:#9aa4b2;
    --editor-bg:#1e1e1e;--editor-border:#2a2a2a;--editor-text:#d4d4d4;
    --select:#264f78;
    --kw:#569cd6;--str:#ce9178;--num:#b5cea8;--com:#6a9955;
}
.light{
    --bg:#f4f6fb;--card:#fff;--border:#e5e7eb;
    --primary:#2563eb;--secondary:#4f46e5;--text:#0f172a;--muted:#475569;
    --editor-bg:#ffffff;--editor-border:#e5e7eb;--editor-text:#1e1e1e;
    --select:#add6ff;
}
*{margin:0;padding:0;box-sizing:border-box;font-family:Inter,Segoe UI,sans-serif}
body{
    min-height:100vh;
    background:radial-gradient(circle at top,#1a1f3c,var(--bg));
    display:flex;justify-content:center;align-items:center;
    color:var(--text)
}
.app{
    width:95%;max-width:1150px;
    background:var(--card);
    backdrop-filter:blur(20px);
    border:1px solid var(--border);
    border-radius:22px;
    padding:28px;
}
.header{display:flex;justify-content:space-between;margin-bottom:14px}
.title h1{
    font-size:26px;font-weight:800;
    background:linear-gradient(135deg,var(--primary),var(--secondary));
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent
}
.toggle{padding:8px 14px;border-radius:10px;border:1px solid var(--border);background:transparent;color:var(--text)}

.editor{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.editor-box{position:relative}
.tabs{display:flex;border-bottom:1px solid var(--border);margin-bottom:6px}
.tab{padding:8px 14px;font-size:13px;color:var(--muted)}
.tab.active{color:var(--text);border-bottom:2px solid var(--primary)}

.editor-wrap{
    position:relative;height:300px;
    background:var(--editor-bg);
    border:1px solid var(--editor-border);
    border-radius:14px;
    overflow:hidden;
    font-family:Consolas,monospace;font-size:14px;
}

/* overlay */
.lines,.code{pointer-events:none;z-index:1}
.lines{
    position:absolute;left:0;top:0;width:42px;
    padding:14px 6px;text-align:right;
    color:#6b7280;line-height:1.55
}
.code{
    position:absolute;left:42px;top:0;right:0;
    padding:14px 16px;white-space:pre-wrap;
    word-break:break-word;line-height:1.55
}
textarea{
    position:absolute;inset:0;
    padding:14px 16px 14px 58px;
    background:transparent;border:none;resize:none;
    font-family:Consolas,monospace;font-size:14px;
    line-height:1.55;outline:none;
    caret-color:#00ffff;
    overflow:auto;white-space:pre-wrap;word-break:break-word;
    color:var(--editor-text);
    -webkit-text-fill-color:var(--editor-text);
    z-index:2;
}
textarea::selection{background:var(--select)}

#output{color:var(--editor-text)}

.actions{margin-top:16px;display:flex;justify-content:center;gap:10px;flex-wrap:wrap}
button{
    padding:10px 18px;border-radius:14px;border:none;
    background:linear-gradient(135deg,var(--primary),var(--secondary));
    color:#fff;font-weight:600;cursor:pointer
}
button.secondary{background:transparent;border:1px solid var(--border);color:var(--text)}
.status,.footer{text-align:center;font-size:13px;color:var(--muted);margin-top:10px}

@media(max-width:900px){
    .editor{grid-template-columns:1fr}
    .lines,.code{display:none!important}
    textarea{padding:14px}
}
</style>
</head>

<body>
<div class="app">

<div class="header">
    <div class="title">
        <h1>Moonz Lua Obfuscator</h1>
        <p>Lua Obfuscator â€¢ Free</p>
    </div>
    <button class="toggle" onclick="toggleTheme()">Toggle Theme</button>
</div>

<div class="editor">

<div class="editor-box">
    <div class="tabs"><div class="tab active">input.lua</div></div>
    <div class="editor-wrap">
        <div class="lines" id="linesIn"></div>
        <pre class="code" id="codeIn"></pre>
        <textarea id="input"></textarea>
    </div>
</div>

<div class="editor-box">
    <div class="tabs"><div class="tab active">output.lua</div></div>
    <div class="editor-wrap">
        <div class="lines" id="linesOut"></div>
        <pre class="code" id="codeOut"></pre>
        <textarea id="output" readonly></textarea>
    </div>
</div>

</div>

<input type="file" id="fileInput" hidden>

<div style="margin-top:10px;text-align:center;">
    <label><input type="checkbox" id="antiTamper" checked> Enable Anti-Tamper</label><br>
    <label><input type="checkbox" id="strongObf"> Enable Strong Obfuscator</label><br>
    <label><input type="checkbox" id="watermark"> Hide Watermark</label>
</div>

<div class="actions">
    <button onclick="openFile()">Open File</button>
    <button onclick="obfuscate()">Obfuscate</button>
    <button class="secondary" onclick="copyOutput()">Copy</button>
    <button class="secondary" onclick="download()">Download</button>
    <button class="secondary" onclick="clearAll()">Clear</button>
</div>

<div class="status" id="status">Status: Ready</div>
<div class="footer">Version V1.2</div>

</div>

<script>
const input=document.getElementById("input");
const output=document.getElementById("output");
const fileInput=document.getElementById("fileInput");
const codeIn=document.getElementById("codeIn");
const codeOut=document.getElementById("codeOut");
const linesIn=document.getElementById("linesIn");
const linesOut=document.getElementById("linesOut");
const isMobile=matchMedia("(max-width:900px)").matches;

function esc(s){return s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}
function highlight(v){
    v=esc(v);
    return v
    .replace(/--.*/g,m=>`<span style="color:var(--com)">${m}</span>`)
    .replace(/"(.*?)"/g,m=>`<span style="color:var(--str)">${m}</span>`)
    .replace(/\b(local|function|end|if|then|while|do|return|for|break)\b/g,
        m=>`<span style="color:var(--kw)">${m}</span>`)
    .replace(/\b\d+\b/g,m=>`<span style="color:var(--num)">${m}</span>`);
}
function sync(t,c,l){
    if(isMobile) return;
    c.innerHTML=highlight(t.value);
    l.innerHTML=Array.from({length:t.value.split("\n").length},(_,i)=>i+1).join("<br>");
}
input.oninput=()=>sync(input,codeIn,linesIn);
output.oninput=()=>sync(output,codeOut,linesOut);
input.onscroll=()=>{if(!isMobile){codeIn.scrollTop=input.scrollTop;linesIn.scrollTop=input.scrollTop}}
output.onscroll=()=>{if(!isMobile){codeOut.scrollTop=output.scrollTop;linesOut.scrollTop=output.scrollTop}}

function r(min,max){return Math.floor(Math.random()*(max-min))+min}
function rv(){return "_" + Math.random().toString(36).slice(2,10)}

function obfuscate(){
    const src=input.value;
    if(!src.trim()) return;

    const k1=r(20,200), k2=r(40,220), km=r(7,19);
    const v1=rv(), v2=rv(), v3=rv(), v4=rv();
    const anti=antiTamper.checked;
    const strong=strongObf.checked;
    const hideWatermark=watermark.checked;

    let data=[];
    for(let i=0;i<src.length;i++){
        let key=(k1+(i+1)*km)%256;
        data.push((src.charCodeAt(i)+key)^k2);
    }
    const chk=data.reduce((a,b)=>a+b,0)%997;

    let lua="";
    if(!hideWatermark)
        lua+=`--[[ Obfuscated by Moonz Obfuscator ]]--\n`;

    lua+=`
local ${v1}={${data.join(",")}}
local ${v2}=${k1}
local ${v3}=${k2}
local ${v4}=${km}
local function bxor(a,b)
    local r=0;p=1
    while a>0 or b>0 do
        if a%2~=b%2 then r=r+p end
        a=math.floor(a/2);b=math.floor(b/2);p=p*2
    end
    return r
end
local t={},i=1
while i<=#${v1} do
    local k=(${v2}+i*${v4})%256
    t[i]=string.char(bxor(${v1}[i],${v3})-k)
    i=i+1
end
`;

    if(anti) lua+=`
local s=0 for i=1,#${v1} do s=s+${v1}[i] end
if s%997~=${chk} then while true do end end
`;
    if(strong) lua+=`
do local c=0 for i=1,#t do c=c+(string.byte(t[i]) or 0) end
if c%1337==0 then while true do end end end
`;
    lua+=`return (loadstring or load)(table.concat(t))()`;

    output.value=lua;
    sync(output,codeOut,linesOut);
}

function openFile(){fileInput.click()}
fileInput.onchange=e=>{
    const r=new FileReader();
    r.onload=()=>{input.value=r.result;sync(input,codeIn,linesIn)}
    r.readAsText(e.target.files[0]);
}
function copyOutput(){navigator.clipboard.writeText(output.value)}
function download(){
    const a=document.createElement("a");
    a.href=URL.createObjectURL(new Blob([output.value]));
    a.download="moonz-obfuscated.lua";
    a.click();
}
function clearAll(){
    input.value="";output.value="";
    sync(input,codeIn,linesIn);sync(output,codeOut,linesOut);
}
function toggleTheme(){document.body.classList.toggle("light")}
</script>

</body>
</html>
